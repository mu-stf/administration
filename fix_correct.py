# -*- coding: utf-8 -*-
"""
Correct Arabic encoding fix - precise replacement mappings
"""
import glob

# Precise mappings - each unique pattern to its correct Arabic text
REPLACEMENTS = {
    # Titles
    "???? ?????? - ???? ????? ?????": "لوحة التحكم - نظام الإدارة المتكامل",
    "?????? ????? - ???? ????? ?????": "فاتورة جديدة - نظام الإدارة المتكامل",
    "????????? - ???? ????? ?????": "الإعدادات - نظام الإدارة المتكامل",
    "???????? - ???? ????? ?????": "الفواتير - نظام الإدارة المتكامل",
    "???? ????? ?????": "نظام الإدارة المتكامل",
    
    # Loading
    "???? ???????...": "جاري التحميل...",
    
    # Logout button (exact pattern)
    "?? ????? ??????": "تسجيل الخروج",
    
    # Navigation items (exact patterns with lengths)
    ">???? ??????<": ">لوحة التحكم<",
    ">?????? ?????<": ">فاتورة جديدة<",
    ">????????<": ">الفواتير<",
    ">????????<": ">المنتجات<",
    ">???????<": ">الزبائن<",
    ">?????????<": ">التوريدات<",
    ">??????????<": ">الإحصائيات<",
    ">?????????<": ">الإعدادات<",
    ">??????????<": ">المستخدمون<",
    
    # Form labels
    ">????? ????????<": ">تاريخ الفاتورة<",
    ">??? ????? *<": ">نوع الدفع *<",
    ">??? ??<": ">نقد كاش<",
    ">??? ??<": ">آجل دين<",
    ">??????<": ">الزبون<",
    ">???? ???? (???)<": ">زبون عام (نقدي)<",
    ">????? ???? ????<": ">إضافة زبون سريع<",
    ">??? ?????? (?????)<": ">اسم الزبون (اختياري)<",
    ">???????<": ">اختياري<",
    
    # Add product section
    ">????? ????<": ">إضافة منتج<",
    ">? ???? ????<": ">+ منتج جديد<",
    ">??? ?? ????<": ">ابحث أو اختر<",
    ">???? ??? ??????...<": ">اكتب اسم المنتج...<",
    ">??????<": ">الكمية<",
    ">? ?????<": ">+ إضافة<",
    
    # Table headers
    ">??????<": ">المنتج<",
    ">?????<": ">السعر<",
    ">??????<": ">الكمية<",
    ">???????<": ">المجموع<",
    
    # Empty state
    ">?? ???? ?????? ???<": ">لا توجد منتجات بعد<",
    
    # Totals section
    ">???????:<": ">المجموع:<",
    ">?????:<": ">الخصم:<",
    ">????????:<": ">الإجمالي:<",
    ">?????? ???????<": ">المبلغ المدفوع<",
    ">???????:<": ">المتبقي:<",
    
    # Buttons
    ">?? ??? ????????<": ">حفظ الفاتورة<",
    ">?????<": ">إلغاء<",
    ">???<": ">حذف<",
    
    # Modal - Add Product
    ">? ????? ???? ????<": ">+ إضافة منتج جديد<",
    ">??? ?????? *<": ">اسم المنتج *<",
    ">????????<": ">الباركود<",
    ">??? ????? *<": ">سعر البيع *<",
    ">??? ??????<": ">سعر الشراء<",
    ">?????? ???????<": ">المخزون المتوفر<",
    ">?? ?????<": ">حفظ المنتج<",
    
    # Stats cards
    ">?????? ?????<": ">فواتير اليوم<",
    ">?????? ?????<": ">مبيعات اليوم<",
    ">????? ?????<": ">أرباح اليوم<",
    ">?????? ?????? ???????<": ">منتجات قليلة المخزون<",
    
    # Quick actions
    ">? ??????? ?????<": ">الإجراءات السريعة<",
    ">? ?????? ?????<": ">+ فاتورة جديدة<",
    ">?? ????? ????<": ">إضافة منتج<",
    ">?? ????? ?????<": ">إضافة توريد<",
    ">?? ??? ??????????<": ">عرض الإحصائيات<",
    
    # Recent invoices
    ">?? ??? ????????<": ">آخر الفواتير<",
    ">??? ????<": ">عرض الكل<",
    ">??? ????????<": ">رقم الفاتورة<",
    ">???????<": ">التاريخ<",
    ">??????<": ">الحالة<",
    ">????<": ">نشطة<",
    ">?????<": ">ملغاة<",
    
    # Low stock
    ">?? ?????? ?????? ???????<": ">المنتجات قليلة المخزون<",
    ">????? ????????<": ">إدارة المنتجات<",
    ">?????? ????????<": ">المخزون الحالي<",
    ">?????<": ">الإجراء<",
    ">?? ?????<": ">طلب توريد<",
    
    # Currency
    "?.?": "د.ع",
    
    # Settings page
    ">?? ??????? ?????<": ">إعدادات المتجر<",
    ">??? ?????<": ">اسم المتجر<",
    ">???? ??? ?????<": ">أدخل اسم المتجر<",
    ">??? ??????<": ">رقم الهاتف<",
    ">???????<": ">العنوان<",
    ">????? ?????<": ">عنوان المتجر<",
    ">??? ??????<": ">اسم الوكيل<",
    ">????? ??? ????????<": ">بادئة رقم الفاتورة<",
    ">?? ??? ?????????<": ">حفظ الإعدادات<",
    ">???? ?????...<": ">جاري الحفظ...<",
    ">?? ??????? ??????<": ">معلومات النظام<",
    ">???????:<": ">الإصدار:<",
    ">????? ????????:<": ">قاعدة البيانات:<",
    ">?????? ??????????:<": ">البريد الإلكتروني:<",
}

def fix_file(filepath):
    try:
        with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read()
        
        for old, new in REPLACEMENTS.items():
            content = content.replace(old, new)
        
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        return True
    except Exception as e:
        print(f"Error: {filepath} - {e}")
        return False

def main():
    files = glob.glob('*.html')
    print(f"Processing {len(files)} files...")
    
    for f in sorted(files):
        if fix_file(f):
            print(f"OK: {f}")
    
    print("\nDone! Refresh browser (Ctrl+F5)")

if __name__ == "__main__":
    main()
